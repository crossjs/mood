/*! mood-1.0.0 2014-03-25 21:26:19 */
define("pandora/mood/1.0.0/mood",["$","./core","pandora/widget/1.0.0/widget","pandora/class/1.0.0/class","pandora/events/1.0.0/events","pandora/widget/1.0.0/aspect","gallery/handlebars/1.0.2/runtime","./template.handlebars","./default.css"],function(a,b,c){"use strict";function d(a){var b=a.match(/\d+(?!#|\d)/g).slice(0,this.data("moods").length),c=0;e.each(this.data("moods"),e.proxy(function(a,d){c+=d.value=+b[a]},this)),this.data({total:c,max:Math.max.apply(null,b)})}var e=a("$"),f=a("./core"),g=(a("gallery/handlebars/1.0.2/runtime"),a("./template.handlebars"));a("./default.css");var h=f.extend({defaults:{element:'<div class="ue-component ue-mood"/>',delegates:{"click .ue-mood-item":function(a){var b=a.currentTarget;this.vote(e(b).index())},"mouseover .ue-mood-smiley":function(a){var b=a.currentTarget;b.originalSrc=b.src,b.src=b.attributes["data-mood-ani"].value},"mouseout .ue-mood-smiley":function(a){var b=a.currentTarget;b.src=b.originalSrc}},moods:"ZHUANQU",template:g,helpers:{helpers:{ratio:function(a,b){return a/b*100+"%"},equal:function(a,b,c){return a===b?c.fn(this):c.inverse(this)}}}},setup:function(){h.superclass.setup.call(this),this.data({moods:h.PRESETS[this.option("moods")],total:0,max:0}),this.on("load",function(){this.showInfo("\u6570\u636e\u52a0\u8f7d\u4e2d\u2026\u2026")}),this.on("vote",function(){this.showInfo("\u6570\u636e\u53d1\u9001\u4e2d\u2026\u2026")}),this.on("done",function(a,b,c){if("load"===b)this.showInfo("\u6570\u636e\u52a0\u8f7d\u6210\u529f"),d.call(this,c.data),this.refresh();else if("vote"===b)switch(c.flag){case"1":this.showInfo("\u6295\u7968\u6210\u529f\uff0c\u611f\u8c22\u4f60\u7684\u53c2\u4e0e"),d.call(this,c.data),this.refresh();break;case"2":break;case"3":break;case"9":this.showInfo("\u60a8\u7684IP\u4eca\u5929\u5df2\u7ecf\u6295\u8fc7\u7968\u4e86, \u611f\u8c22\u60a8\u7684\u53c2\u4e0e")}}),this.on("fail",function(a,b){"load"===b?this.showInfo("\u6570\u636e\u52a0\u8f7d\u5931\u8d25"):"vote"===b&&this.showInfo("\u6570\u636e\u53d1\u9001\u5931\u8d25")}),this.load()},refresh:function(){this.rendered||this.render(),this.element.html(this.option("template")(this.data(),this.option("helpers"))),this.hideInfo()},showInfo:function(a){this.element?this.element.find(".ue-mood-msgbox").text(a).fadeIn():this.data("msg",a)},hideInfo:function(){this.element?this.element.find(".ue-mood-msgbox").fadeOut():this.data("msg","")}});h.PRESETS={ZHUANQU:[{name:"\u56e7\u96f7\u65e0\u6bd4",img:"http://ue1.17173.itc.cn/2009newsend/jiong_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/jiong_2.gif"},{name:"\u9171\u6cb9\u8def\u8fc7",img:"http://i3.17173.itc.cn/2011/news/2011/05/19/jy1.gif",ani:"http://i3.17173.itc.cn/2011/news/2011/05/19/jy2.gif"},{name:"\u4fdd\u6301\u5173\u6ce8",img:"http://ue1.17173.itc.cn/2009newsend/guanzhu_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/guanzhu_2.gif"},{name:"\u5341\u5206\u7cbe\u5f69",img:"http://ue1.17173.itc.cn/2009newsend/se_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/se_2.gif"},{name:"\u503c\u5f97\u4e00\u770b",img:"http://ue1.17173.itc.cn/2009newsend/bucuo_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/bucuo_2.gif"},{name:"\u6012\u53d1\u51b2\u51a0",img:"http://i3.17173.itc.cn/2011/www/fl00.gif",ani:"http://i2.17173.itc.cn/2011/www/fl11.gif"},{name:"\u4e0d\u77e5\u6240\u4e91",img:"http://i3.17173.itc.cn/2011/www/yw00.gif",ani:"http://i2.17173.itc.cn/2011/www/yw11.gif"}],NEWS:[{name:"\u86cb\u75bc",img:"http://ue1.17173.itc.cn/2009newsend/2012/danteng-1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/2012/danteng-2.gif"},{name:"\u6076\u5fc3",img:"http://ue1.17173.itc.cn/2009newsend/tu_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/tu_2.gif"},{name:"\u671f\u5f85",img:"http://ue1.17173.itc.cn/2009newsend/se_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/se_2.gif"},{name:"\u96be\u8fc7",img:"http://ue1.17173.itc.cn/2009newsend/ku_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/ku_2.gif"},{name:"\u7889\u5821",img:"http://ue1.17173.itc.cn/2009newsend/2012/diaobao-1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/2012/diaobao-2.gif"},{name:"\u5173\u6ce8",img:"http://ue1.17173.itc.cn/2009newsend/guanzhu_1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/guanzhu_2.gif"},{name:"\u9171\u6cb9",img:"http://i3.17173.itc.cn/2011/news/2011/05/19/jy1.gif",ani:"http://i3.17173.itc.cn/2011/news/2011/05/19/jy2.gif"},{name:"\u6124\u6012",img:"http://ue1.17173.itc.cn/2009newsend/2012/fennu-1.gif",ani:"http://ue1.17173.itc.cn/2009newsend/2012/fennu-2.gif"}]},h.Core=f,c.exports=h}),define("pandora/mood/1.0.0/core",["$","pandora/widget/1.0.0/widget","pandora/class/1.0.0/class","pandora/events/1.0.0/events","pandora/widget/1.0.0/aspect"],function(a,b,c){"use strict";function d(a,b,c){e.getJSON(g.URL,a).done(b).fail(c)}var e=a("$"),f=a("pandora/widget/1.0.0/widget"),g=f.extend({setup:function(){this.data("params",{channel:this.option("channelId"),web_id:this.option("webId"),kind:this.option("kindId")}),this.state(g.STATE.NORMAL)},load:function(){var a=this,b=e.extend({action:"0"},this.data("params"));this.fire("load"),this.state(g.STATE.RECEIVING),d.call(this,b,function(b){a.fire("done","load",b)},function(b,c){a.fire("fail","load",c)})},vote:function(a){var b=this,c=e.extend({action:"1",mood:a+1},this.data("params"));this.fire("vote"),this.state(g.STATE.SENDING),d.call(this,c,function(a){b.fire("done","vote",a)},function(a,c){b.fire("fail","vote",c)})}});g.STATE={ERROR:-1,NORMAL:0,RECEIVING:1,SENDING:2},g.URL="http://hits.17173.com/mood/mood_opb.php?jsonp=?",c.exports=g}),define("pandora/mood/1.0.0/template.handlebars",["gallery/handlebars/1.0.2/runtime"],function(a,b,c){var d=a("gallery/handlebars/1.0.2/runtime"),e=d.template;c.exports=e(function(a,b,c,d,e){function f(a,b,d){var e,f,i,j="";return j+='\r\n      <td class="ue-mood-item" align="center">\r\n        <span class="value">',(e=c.value)?e=e.call(a,{hash:{},data:b}):(e=a.value,e=typeof e===m?e.apply(a):e),j+=n(e)+'</span>\r\n        <div class="rect-wrapper">\r\n          <img class="rect" width="31" height="',i={hash:{},data:b},j+=n((e=c.ratio,e?e.call(a,a.value,d.total,i):o.call(a,"ratio",a.value,d.total,i)))+'" src="http://ue2.17173.itc.cn/images/lib/v2/mood-1.0/default-rect-',i={hash:{},inverse:p.program(4,h,b),fn:p.program(2,g,b),data:b},e=c.equal,f=e?e.call(a,a.value,d.max,i):o.call(a,"equal",a.value,d.max,i),(f||0===f)&&(j+=f),j+='.gif">\r\n        </div>\r\n        <img class="ue-mood-smiley" src="',(f=c.img)?f=f.call(a,{hash:{},data:b}):(f=a.img,f=typeof f===m?f.apply(a):f),j+=n(f)+'" data-mood-ani="',(f=c.ani)?f=f.call(a,{hash:{},data:b}):(f=a.ani,f=typeof f===m?f.apply(a):f),j+=n(f)+'">\r\n        <div>',(f=c.name)?f=f.call(a,{hash:{},data:b}):(f=a.name,f=typeof f===m?f.apply(a):f),j+=n(f)+"</div>\r\n      </td>\r\n    "}function g(){return"max"}function h(){return"normal"}this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||{};for(var i in a.helpers)c[i]=c[i]||a.helpers[i];e=e||{};var j,k,l="",m="function",n=this.escapeExpression,o=c.helperMissing,p=this,q=c.blockHelperMissing;return l+='<div class="mood-ui-default">\r\n  <div class="ue-mood-msgbox">',(j=c.msg)?j=j.call(b,{hash:{},data:e}):(j=b.msg,j=typeof j===m?j.apply(b):j),l+=n(j)+'</div>\r\n  <table>\r\n    <caption class="ue-mood-total">',(j=c.total)?j=j.call(b,{hash:{},data:e}):(j=b.total,j=typeof j===m?j.apply(b):j),l+=n(j)+"</caption>\r\n    <tr>\r\n    ",k={hash:{},inverse:p.noop,fn:p.programWithDepth(1,f,e,b),data:e},(j=c.moods)?j=j.call(b,k):(j=b.moods,j=typeof j===m?j.apply(b):j),c.moods||(j=q.call(b,j,k)),(j||0===j)&&(l+=j),l+="\r\n    </tr>\r\n  </table>\r\n</div>"})}),define("pandora/mood/1.0.0/default.css",[],function(){seajs.importStyle('.mood-ui-default{font-size:14px;font-family:Arial,"\u5b8b\u4f53"}.mood-ui-default .total{color:red;font-weight:700}.mood-ui-default td{font-size:14px;color:#2b2b2b}.mood-ui-default .rect-wrapper{position:relative;height:70px;width:33px;overflow:hidden;border:1px solid #ccc;background-color:#f7f7f7}.mood-ui-default .rect{position:absolute;bottom:1px;left:1px}.mood-ui-default .ue-mood-smiley{cursor:pointer}.mood-ui-default .msgbox{font-size:12px;color:gray;width:220px;height:20px;padding:40px;text-align:center;line-height:20px;background-color:#fff;border:1px solid gray;position:absolute;z-index:100}')});